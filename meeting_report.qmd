---
title: "Montréal Urban Perceptions Meeting"
date: January 26, 2023
format: 
  html:
    fig-width: 12
    fig-height: 10
    embed-resources: true
---

```{r}
#| label: setup
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE

library(targets)
library(ggplot2)
library(tidyr)
library(dplyr)

source("R/make_boxplot.R")
source("R/make_barplot.R")

mtl_clean <- tar_read(mtl_clean)

```

### Background

We want to explore how people's perceptions of urban trees varies with their sociodemographics. Specifically, we want to dig deeper into understanding people's perceptions in *Montréal*. We want to use the survey data to ask more pointed and meaningful questions about Montréal specifically (e.g., examine the issue of language).

There is potential for 2+ papers here. Following the first meeting, we decided that the questions of governance and management could be tackled by Emile in a separate paper, as he has a lot of expertise in this field.

This paper will be focused on questions regarding the valuation and beliefs surrounding urban trees (as opposed to questions of governance, tree knowledge, etc.)

------------------------------------------------------------------------

### Proposed Research Question

How are Montréal residents' values and beliefs concerning urban trees influenced by city type, country of origin, preferred language, dwelling type, education level?

-   **Dependent variables:**

    -   Tree Value survey questions (15) - e.g., How important to you are each of the following things about these trees: large old trees?
    -   Tree Beliefs (Negative) survey questions (12) - e.g., How much do you agree that the trees in your city or neighbourhood are ugly?\
    -   Tree Beliefs (Positive) survey questions (12) - e.g., How much do you agree that the trees in your city or neighbourhood are calming?

-   **Independent variables:**

    -   City type (inner, middle, outer, regional)
    -   Country of origin (Canadian born with Canadian born parents, Canadian born with parents born abroad, born abroad)
    -   Preferred language(English, French, Other with preferred official language English, Other with preferred official language French)
    -   Dwelling type (house, apartment in a house, apartment in a building, other, prefer not to answer)
    -   Education level (prefer not to answer, did not complete high school, high school, trade school, bac, masters, doc)

**Justification:** People's values and beliefs concerning urban trees are inherently tied to the delivery and access of ecosystem services. To effectively manage and produce ecosystem services that truly serve people, we require knowledge surrounding what people value and what drives individual differences in values. The independent variables were selected based on the variables shown to influence street tree cover in Pham et al. (2017). In addition, we are testing the effect of city type on tree values and beliefs, as there is literature showing a divide in conceptions of nature between urban and rural residents.

**Hypothesis:** values and beliefs concerning urban trees are influenced by sociodemographics directly, as well as indirectly through differing exposure to trees (i.e., amount of street tree cover in your neighbourhood).

**Predictions:** would love some help from Hiên and Emile to craft some predictions for each independent variable (e.g., how do we predict level of education will influence values and beliefs concerning urban trees?). I am happy to craft them together but I think the social science expertise offered by Hiên and Emile will strengthen the predictions a lot.

------------------------------------------------------------------------

### Street Tree Cover

The variables selected: country of origin, preferred language, dwelling type, and education level are all based on Pham et al. (2017), which demonstrates the relationship between these variables and *street tree cover* in Montreal. We can conceive of the relationship between these sociodemographic variables and values and beliefs surrounding urban trees as **direct** and **indirect**, where the indirect effect is the effects of sociodemographics on tree values and beliefs *through* street tree cover. This begs the question:

> Should we add street tree cover to our models?

-   Without adding street tree cover, we can measure the *total effect* of sociodemographics on people's values/beliefs (this includes the unmeasured effect of the influence of street tree cover on their values/beliefs). If we choose to add street tree cover, we can measure the *direct effect* of sociodemographics on people's values and beliefs by controlling for street tree cover.

```{dot}
//| label: DAG
//| fig-width: 8
//| fig-align: center
digraph G {
    
    bgcolor="transparent"
    node [style=filled,color=white]
    edge [color="black"]
    
    rankdir=LR
    
    Sociodemographics [shape=box]
    Tree_Values_Beliefs [shape=box]
    
    Sociodemographics -> Street_Tree_Cover;
    Sociodemographics -> Tree_Values_Beliefs;
    Street_Tree_Cover -> Tree_Values_Beliefs;
    
}
```

-   To measure street tree cover, we would assign respondents a "neighbourhood" using the first 3 digits of postal codes, and then measure the average canopy cover in that area.

-   Potential Issues:

    -   Only 2/3 (\~1,100) of respondents provided this information, so we would lose some data
    -   Postal code areas have wide variation in size, especially in rural areas they are quite large, so this may not facilitate the best comparison

------------------------------------------------------------------------
## Data Visualization

### Tree Values

There are 16 questions that we asked survey respondents regarding how they value urban trees. They are as follows (~~strikethrough~~ indicates no significant relationship with any of our independent variables, significant relationships will be visualized below):

How important to you are each of the following things about these trees

-   large old trees

-   a place for human history and stories

-   ~~getting away from stresses of everyday life~~

-   a place for a short walk

-   learning about cultural traditions

-   ~~a place that is accessible for everybody~~

-   clean air, clean water, and healthy cities

-   many kinds of native animals, birds, and plants

-   make the city more welcoming

-   a more liveable city

-   ~~spaces for people to interact and socialize~~

-   trees improving community cohesion

-   beautiful sights, sounds, and smells

-   ~~a healthy environment that supports human life~~

-   ~~attracting tourists and residents to the city~~

-   maintain Indigenous or European cultures

Each independent variable that was significantly associated with one or more of the questions is visualized in both a boxplot and barplot below.

```{r}
#| label: fig-valueedu
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where education level is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where education level is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each education level.

mtl_val_edu <- mtl_clean %>% 
  select(edu, uf_vals_large_old_trees, uf_vals_learning_about_cultural_traditions,
         uf_vals_clean_air_clean_water_and_healthy_cities, uf_vals_make_the_city_more_welcoming,
         uf_vals_a_more_liveable_city, uf_vals_improving_community_cohesion,
         uf_vals_beautiful_sights_sounds_and_smells,
         uf_vals_maintaining_aboriginal_or_european_culture)


long_val_edu <- pivot_longer(mtl_val_edu, cols = starts_with("uf_vals"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "uf_vals_large_old_trees" ~ "large old trees",
                              question == "uf_vals_learning_about_cultural_traditions" ~ "cultural traditions",
                              question == "uf_vals_clean_air_clean_water_and_healthy_cities" ~ "clean cities",
                              question == "uf_vals_make_the_city_more_welcoming" ~ "welcoming city",
                              question == "uf_vals_a_more_liveable_city" ~ "liveable city",
                              question == "uf_vals_improving_community_cohesion" ~ "community cohesion",
                              question == "uf_vals_beautiful_sights_sounds_and_smells" ~ "beauty",
                              question == "uf_vals_maintaining_aboriginal_or_european_culture" ~ "maintaining culture"),
         
         edu = case_when(edu == 0 ~ "N/A",
                         edu == 1 ~ "No High School",
                         edu == 2 ~ "High School",
                         edu == 3 ~ "Trade School",
                         edu == 4 ~ "Bac",
                         edu == 5 ~ "Masters",
                         edu == 6 ~ "Doc"))

make_boxplot(long_val_edu, long_val_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

make_barplot(long_val_edu, long_val_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

```

```{r}
#| label: fig-valueimm
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where country of origin is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where country of origin is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each country of origin option.

mtl_val_imm <- mtl_clean %>% 
  select(immigrant, uf_vals_large_old_trees,
         uf_vals_habitat_for_rare_or_threatened_plants_birds_and_animals)

long_val_imm <- pivot_longer(mtl_val_imm, cols = starts_with("uf_vals"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "uf_vals_large_old_trees" ~ "large old trees",
                              question == "uf_vals_habitat_for_rare_or_threatened_plants_birds_and_animals" ~ "habitat"),
         immigrant = case_when(immigrant == 1 ~ "Born Canadian, Parents Born Canadian",
                               immigrant == 2 ~ "Born Canadian, Parents Born Abroad", 
                               immigrant == 3 ~ "Born Abroad"))


make_boxplot(long_val_imm, long_val_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_val_imm, long_val_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))
```

```{r}
#| label: fig-valuelang
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where first language is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where first language is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each first language option.
 

mtl_val_lang <- mtl_clean %>% 
  select(firstlanguage, uf_vals_a_place_for_human_history_and_stories, uf_vals_a_place_for_a_short_walk,
         uf_vals_learning_about_cultural_traditions,
         uf_vals_habitat_for_rare_or_threatened_plants_birds_and_animals,
         uf_vals_maintaining_aboriginal_or_european_culture)

long_val_lang <- pivot_longer(mtl_val_lang, cols = starts_with("uf_vals"), names_to = "question", values_to = "response") %>% 
  mutate(question = case_when(question == "uf_vals_a_place_for_human_history_and_stories" ~ "human history and stories",
                              question == "uf_vals_a_place_for_a_short_walk" ~ "walking",
                              question == "uf_vals_learning_about_cultural_traditions" ~ "cultural",
                              question == "uf_vals_habitat_for_rare_or_threatened_plants_birds_and_animals" ~ "habitat",
                              question == "uf_vals_maintaining_aboriginal_or_european_culture" ~ "maintaining culture"),
         firstlanguage = case_when(firstlanguage == 1 ~ "French first language",
                                   firstlanguage == 2 ~ "English first language",
                                   firstlanguage == 3 ~ "French preferred official language",
                                   firstlanguage == 4 ~ "English preferred official language"))

make_boxplot(long_val_lang, long_val_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

make_barplot(long_val_lang, long_val_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

```

```{r}
#| label: fig-valuedwel
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where housing status is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where housing status is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each housing status.
mtl_val_dwel <- mtl_clean %>% 
  select(housing_code, uf_vals_maintaining_aboriginal_or_european_culture)

long_val_dwel <- pivot_longer(mtl_val_dwel, cols = starts_with("uf_vals"), names_to = "question", values_to = "response") %>% 
  mutate(question = case_when(question == "uf_vals_maintaining_aboriginal_or_european_culture" ~ "maintaining culture"),
         housing_code = case_when(housing_code == 1 ~ "own",
                                  housing_code == 2 ~ "rent",
                                  housing_code == 3 ~ "other"))

make_boxplot(long_val_dwel, long_val_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_val_dwel, long_val_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))
```

------------------------------------------------------------------------

### Tree Beliefs (Negative)

There are 14 questions that we asked survey respondents regarding their negative beliefs about urban trees. They are as follows (~~strikethrough~~ indicates no significant relationship with any of our independent variables, significant relationships will be visualized below):

How much do you agree that trees in your city or neighbourhood

-   ~~cause allergies~~
-   block the visibility of road signs
-   damage property including concrete paths and power lines
-   create mess
-   are ugly
-   use too much water
-   block water pipes and drains
-   block the sun
-   are expensive to maintain
-   drop branches
-   take up too much space
-   promote wildfires
-   attract undesirable animals
-   make me feel stressed

Each independent variable that was significantly associated with one or more of the questions is visualized in both a boxplot and barplot below.

```{r}
#| label: fig-negedu
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where education level is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where education level is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each education level.

mtl_neg_edu <- mtl_clean %>% 
  select(edu, beliefs_negatives_block_the_visibility_of_road_signs, 
         beliefs_negatives_damage_property_including_concrete_paths_and_powerlines,
         beliefs_negatives_create_mess, beliefs_negatives_are_ugly, beliefs_negatives_use_too_much_water,
         beliefs_negatives_block_water_pipes_and_drains, beliefs_negatives_take_up_too_much_space,
         beliefs_negatives_promote_wildfires, beliefs_negatives_attract_undesirable_animals, 
         beliefs_extra_negative_make_me_feel_stressed)


long_neg_edu <- pivot_longer(mtl_neg_edu, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_negatives_block_the_visibility_of_road_signs" ~ "block visibility",
                              question == "beliefs_negatives_damage_property_including_concrete_paths_and_powerlines" ~ "damage property",
                              question == "beliefs_negatives_create_mess" ~ "messy",
                              question == "beliefs_negatives_are_ugly" ~ "ugly",
                              question == "beliefs_negatives_use_too_much_water" ~ "use too much water",
                              question == "beliefs_negatives_block_water_pipes_and_drains" ~ "block pipes",
                              question == "beliefs_negatives_take_up_too_much_space" ~ "take up too much space",
                              question == "beliefs_negatives_promote_wildfires" ~ "promote wildfires",
                              question == "beliefs_negatives_attract_undesirable_animals" ~ "attract undesirable animals",
                              question == "beliefs_extra_negative_make_me_feel_stressed" ~ "stressful"),
         
         edu = case_when(edu == 0 ~ "N/A",
                         edu == 1 ~ "No High School",
                         edu == 2 ~ "High School",
                         edu == 3 ~ "Trade School",
                         edu == 4 ~ "Bac",
                         edu == 5 ~ "Masters",
                         edu == 6 ~ "Doc"))

make_boxplot(long_neg_edu, long_neg_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

make_barplot(long_neg_edu, long_neg_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

```

```{r}
#| label: fig-negimm
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where country of origin is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where country of origin is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each country of origin option.

mtl_neg_imm <- mtl_clean %>% 
  select(immigrant, beliefs_negatives_block_the_visibility_of_road_signs, 
         beliefs_negatives_damage_property_including_concrete_paths_and_powerlines,
         beliefs_negatives_create_mess, beliefs_negatives_are_ugly, beliefs_negatives_use_too_much_water,
         beliefs_negatives_are_expensive_to_maintain, beliefs_negatives_take_up_too_much_space,
         beliefs_negatives_promote_wildfires, beliefs_negatives_attract_undesirable_animals, 
         beliefs_extra_negative_make_me_feel_stressed)

long_neg_imm <- pivot_longer(mtl_neg_imm, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_negatives_block_the_visibility_of_road_signs" ~ "block visibility",
                              question == "beliefs_negatives_damage_property_including_concrete_paths_and_powerlines" ~ "damage property",
                              question == "beliefs_negatives_create_mess" ~ "messy",
                              question == "beliefs_negatives_are_ugly" ~ "ugly",
                              question == "beliefs_negatives_use_too_much_water" ~ "use too much water",
                              question == "beliefs_negatives_are_expensive_to_maintain" ~ "expensive",
                              question == "beliefs_negatives_take_up_too_much_space" ~ "take up too much space",
                              question == "beliefs_negatives_promote_wildfires" ~ "promote wildfires",
                              question == "beliefs_negatives_attract_undesirable_animals" ~ "attract undesirable animals",
                              question == "beliefs_extra_negative_make_me_feel_stressed" ~ "stressful"),
         immigrant = case_when(immigrant == 1 ~ "Born Canadian, Parents Born Canadian",
                               immigrant == 2 ~ "Born Canadian, Parents Born Abroad", 
                               immigrant == 3 ~ "Born Abroad"))


make_boxplot(long_neg_imm, long_neg_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_neg_imm, long_neg_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))
```

```{r}
#| label: fig-neglang
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where first language is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where first language is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each first language option.
 

mtl_neg_lang <- mtl_clean %>% 
  select(firstlanguage, beliefs_negatives_take_up_too_much_space)

long_neg_lang <- pivot_longer(mtl_neg_lang, cols = starts_with("beliefs_"), names_to = "question", 
                              values_to = "response") %>% 
  mutate(question = case_when(question == "beliefs_negatives_take_up_too_much_space" ~ "take up too much space"),
         firstlanguage = case_when(firstlanguage == 1 ~ "French first language",
                                   firstlanguage == 2 ~ "English first language",
                                   firstlanguage == 3 ~ "French preferred official language",
                                   firstlanguage == 4 ~ "English preferred official language"))

make_boxplot(long_neg_lang, long_neg_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

make_barplot(long_neg_lang, long_neg_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

```

```{r}
#| label: fig-negdwel
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where housing status is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where housing status is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each housing status.
mtl_neg_dwel <- mtl_clean %>% 
  select(housing_code, beliefs_negatives_are_ugly, beliefs_negatives_block_water_pipes_and_drains,
         beliefs_negatives_promote_wildfires)

long_neg_dwel <- pivot_longer(mtl_neg_dwel, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>% 
  mutate(question = case_when(question == "beliefs_negatives_are_ugly" ~ "ugly",
                              question == "beliefs_negatives_block_water_pipes_and_drains" ~ "block pipes",
                              question == "beliefs_negatives_promote_wildfires" ~ "promote wildfires"),
         housing_code = case_when(housing_code == 1 ~ "own",
                                  housing_code == 2 ~ "rent",
                                  housing_code == 3 ~ "other"))

make_boxplot(long_neg_dwel, long_neg_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_neg_dwel, long_neg_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))
```

```{r}
#| label: fig-negdweltyp
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where dwelling type is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where dwelling type is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each dwelling type.

mtl_neg_dtype <- mtl_clean %>% 
  select(housing_type_of_dwelling,    
         beliefs_negatives_damage_property_including_concrete_paths_and_powerlines,
         beliefs_negatives_create_mess, beliefs_negatives_are_ugly, beliefs_negatives_block_the_sun,
         beliefs_negatives_block_water_pipes_and_drains, beliefs_negatives_take_up_too_much_space,
         beliefs_negatives_promote_wildfires, beliefs_negatives_attract_undesirable_animals, 
         beliefs_extra_negative_make_me_feel_stressed)


long_neg_dtype <- pivot_longer(mtl_neg_dtype, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_negatives_damage_property_including_concrete_paths_and_powerlines" ~ "damage property",
                              question == "beliefs_negatives_create_mess" ~ "messy",
                              question == "beliefs_negatives_are_ugly" ~ "ugly",
                              question == "beliefs_negatives_block_the_sun" ~ "block sun",
                              question == "beliefs_negatives_block_water_pipes_and_drains" ~ "block pipes",
                              question == "beliefs_negatives_take_up_too_much_space" ~ "take up too much space",
                              question == "beliefs_negatives_promote_wildfires" ~ "promote wildfires",
                              question == "beliefs_negatives_attract_undesirable_animals" ~ "attract undesirable animals",
                              question == "beliefs_extra_negative_make_me_feel_stressed" ~ "stressful"),
         
         housing_type_of_dwelling = case_when(housing_type_of_dwelling == 1 ~ "House",
                         housing_type_of_dwelling == 2 ~ "Apartment in House",
                         housing_type_of_dwelling == 3 ~ "Apartment in Building",
                         housing_type_of_dwelling == 4 ~ "Other",
                         housing_type_of_dwelling == 5 ~ "N/A"))

make_boxplot(long_neg_dtype, long_neg_dtype$housing_type_of_dwelling, c("House", "Apartment in House", "Apartment in Building", "Other", "N/A"), c("#c2d6a4", "#669d62", "#3c7c3d", "#1e3d14", "grey"))

make_barplot(long_neg_dtype, long_neg_dtype$housing_type_of_dwelling, c("House", "Apartment in House", "Apartment in Building", "Other", "N/A"), c("#c2d6a4", "#669d62", "#3c7c3d", "#1e3d14", "grey"))

```

```{r}
#| label: fig-negcitytype
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where city type is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where city type is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each city type.

mtl_neg_ctype <- mtl_clean %>% 
  select(city_type, beliefs_negatives_attract_undesirable_animals)


long_neg_ctype <- pivot_longer(mtl_neg_ctype, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_negatives_attract_undesirable_animals" ~ "attract undesirable animals"),
         
         city_type = case_when(city_type == 1 ~ "inner",
                         city_type == 2 ~ "middle",
                         city_type == 3 ~ "outer",
                         city_type == 4 ~ "regional"))

make_boxplot(long_neg_ctype, long_neg_ctype$city_type, c("inner", "middle", "outer", "regional"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

make_barplot(long_neg_ctype, long_neg_ctype$city_type, c("inner", "middle", "outer", "regional"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

```


------------------------------------------------------------------------

### Tree Beliefs (Positive)

There are 13 questions that we asked survey respondents regarding their positive beliefs about urban trees. They are as follows (~~strikethrough~~ indicates no significant relationship with any of our independent variable, significant relationships will be visualized below):

How much do you agree that trees in your city or neighbourhood

-   attract desirable animals
-   ~~screen unattractive views~~
-   make streets and parks safer
-   are calming
-   clean the air
-   provide shade
-   produce oxygen
-   cool the neighbourhood
-   reduce flooding
-   make a place good for shopping
-   increase property value
-   are spiritual
-   make me feel healthy

Each independent variable that was significantly associated with one or more of the questions is visualized in both a boxplot and barplot below.

```{r}
#| label: fig-posedu
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where education level is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where education level is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each education level.

mtl_pos_edu <- mtl_clean %>% 
  select(edu, beliefs_positives_are_calming, beliefs_positives_clean_the_air, beliefs_positives_provide_shade, 
         beliefs_positives_cool_the_neighborhood, beliefs_positives_reduce_flooding, beliefs_positives_make_a_place_good_for_shopping,
         beliefs_positives_increase_property_values, beliefs_extra_positive_make_me_feel_healthy)


long_pos_edu <- pivot_longer(mtl_pos_edu, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_positives_are_calming" ~ "calming",
                              question == "beliefs_positives_clean_the_air" ~ "clean air",
                              question == "beliefs_positives_provide_shade" ~ "provide shade",
                              question == "beliefs_positives_cool_the_neighborhood" ~ "cool the neighbourhood",
                              question == "beliefs_positives_reduce_flooding" ~ "reduce flooding",
                              question == "beliefs_positives_make_a_place_good_for_shopping" ~ "facilitate shopping",
                              question == "beliefs_positives_increase_property_values" ~ "increase property values",
                              question == "beliefs_extra_positive_make_me_feel_healthy" ~ "make me feel healthy"),
         
         edu = case_when(edu == 0 ~ "N/A",
                         edu == 1 ~ "No High School",
                         edu == 2 ~ "High School",
                         edu == 3 ~ "Trade School",
                         edu == 4 ~ "Bac",
                         edu == 5 ~ "Masters",
                         edu == 6 ~ "Doc"))

make_boxplot(long_pos_edu, long_pos_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

make_barplot(long_pos_edu, long_pos_edu$edu, c("No High School", "High School", "Trade School", "Bac", "Masters", "Doc", "N/A"), c("#c2d6a4", "#9cc184", "#669d62", "#3c7c3d", "#1f5b25", "#1e3d14", "grey"))

```

```{r}
#| label: fig-posimm
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where country of origin is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where country of origin is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each country of origin option.

mtl_pos_imm <- mtl_clean %>% 
  select(immigrant, beliefs_positives_attract_desirable_animals, beliefs_positives_are_calming, beliefs_positives_clean_the_air,
         beliefs_positives_provide_shade, beliefs_positives_make_a_place_good_for_exercise_walk_run_cycle,
         beliefs_positives_make_a_place_good_for_shopping, beliefs_positives_increase_property_values)

long_pos_imm <- pivot_longer(mtl_pos_imm, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_positives_attract_desirable_animals" ~ "attract desirable animals",
                              question == "beliefs_positives_are_calming" ~ "calming",
                              question == "beliefs_positives_clean_the_air" ~ "clean air",
                              question == "beliefs_positives_provide_shade" ~ "provide shade",
                              question == "beliefs_positives_make_a_place_good_for_exercise_walk_run_cycle" ~ "good exercise space",
                              question == "beliefs_positives_make_a_place_good_for_shopping" ~ "facilitate shopping",
                              question == "beliefs_positives_increase_property_values" ~ "increase property values"),
         
         immigrant = case_when(immigrant == 1 ~ "Born Canadian, Parents Born Canadian",
                               immigrant == 2 ~ "Born Canadian, Parents Born Abroad", 
                               immigrant == 3 ~ "Born Abroad"))


make_boxplot(long_pos_imm, long_pos_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_pos_imm, long_pos_imm$immigrant, c("Born Canadian, Parents Born Canadian", "Born Canadian, Parents Born Abroad", "Born Abroad"), c("#c2d6a4", "#669d62", "#192813"))
```

```{r}
#| label: fig-poslang
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where first language is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where first language is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each first language option.
 

mtl_pos_lang <- mtl_clean %>% 
  select(firstlanguage, beliefs_positives_are_calming, beliefs_positives_make_a_place_good_for_shopping, 
         beliefs_positives_are_spiritual)

long_pos_lang <- pivot_longer(mtl_pos_lang, cols = starts_with("beliefs_"), names_to = "question", 
                              values_to = "response") %>% 
  mutate(question = case_when(question == "beliefs_positives_are_calming" ~ "calming",
                              question == "beliefs_positives_make_a_place_good_for_shopping" ~ "facilitate shopping",
                              question == "beliefs_positives_are_spiritual" ~ "are spiritual"),
         
         firstlanguage = case_when(firstlanguage == 1 ~ "French first language",
                                   firstlanguage == 2 ~ "English first language",
                                   firstlanguage == 3 ~ "French preferred official language",
                                   firstlanguage == 4 ~ "English preferred official language"))

make_boxplot(long_pos_lang, long_pos_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

make_barplot(long_pos_lang, long_pos_lang$firstlanguage, c("French first language", "English first language", "French preferred official language", "English preferred official language"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

```

```{r}
#| label: fig-posdwel
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where housing status is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where housing status is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each housing status.
mtl_pos_dwel <- mtl_clean %>% 
  select(housing_code, beliefs_positives_make_streets_and_parks_safer, beliefs_positives_provide_shade,
         beliefs_positives_produce_oxygen, beliefs_positives_are_spiritual)

long_pos_dwel <- pivot_longer(mtl_pos_dwel, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>% 
  mutate(question = case_when(question == "beliefs_positives_make_streets_and_parks_safer" ~ "increase safety",
                              question == "beliefs_positives_provide_shade" ~ "provide shade",
                              question == "beliefs_positives_are_spiritual" ~ "are spiritual"),
         
         housing_code = case_when(housing_code == 1 ~ "own",
                                  housing_code == 2 ~ "rent",
                                  housing_code == 3 ~ "other"))

make_boxplot(long_pos_dwel, long_pos_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))

make_barplot(long_pos_dwel, long_pos_dwel$housing_code, c("own", "rent", "other"), c("#c2d6a4", "#669d62", "#192813"))
```

```{r}
#| label: fig-posdweltyp
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where dwelling type is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where dwelling type is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each dwelling type.

mtl_pos_dtype <- mtl_clean %>% 
  select(housing_type_of_dwelling, beliefs_positives_attract_desirable_animals, beliefs_positives_are_calming, 
         beliefs_positives_make_a_place_good_for_exercise_walk_run_cycle, beliefs_positives_increase_property_values,
         beliefs_extra_positive_make_me_feel_healthy)


long_pos_dtype <- pivot_longer(mtl_pos_dtype, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_positives_attract_desirable_animals" ~ "attract desirable animals",
                              question == "beliefs_positives_are_calming" ~ "calming",
                              question == "beliefs_positives_make_a_place_good_for_exercise_walk_run_cycle" ~ "good exercise space",
                              question == "beliefs_positives_increase_property_values" ~ "increase property values",
                              question == "beliefs_extra_positive_make_me_feel_healthy" ~ "make me feel healthy"),
         
         housing_type_of_dwelling = case_when(housing_type_of_dwelling == 1 ~ "House",
                         housing_type_of_dwelling == 2 ~ "Apartment in House",
                         housing_type_of_dwelling == 3 ~ "Apartment in Building",
                         housing_type_of_dwelling == 4 ~ "Other",
                         housing_type_of_dwelling == 5 ~ "N/A"))

make_boxplot(long_pos_dtype, long_pos_dtype$housing_type_of_dwelling, c("House", "Apartment in House", "Apartment in Building", "Other", "N/A"), c("#c2d6a4", "#669d62", "#3c7c3d", "#1e3d14", "grey"))

make_barplot(long_pos_dtype, long_pos_dtype$housing_type_of_dwelling, c("House", "Apartment in House", "Apartment in Building", "Other", "N/A"), c("#c2d6a4", "#669d62", "#3c7c3d", "#1e3d14", "grey"))

```

```{r}
#| label: fig-poscitytype
#| echo: FALSE
#| eval: TRUE
#| warning: FALSE
#| fig-subcap: 
#|   - Boxplot showing questions (x-axis) where city type is significantly associated to the question. Response levels in terms of "agreement" are on y-axis. 
#|   - Barplot with each panel showing a distinct question where city type is significatly associated to the question. X-axis denotes the level of agreement respondents gave with the question and y-axis is counts for each level. Bar plots are split in proportion of each city type.

mtl_pos_ctype <- mtl_clean %>% 
  select(city_type, beliefs_positives_cool_the_neighborhood, beliefs_positives_are_spiritual)


long_pos_ctype <- pivot_longer(mtl_pos_ctype, cols = starts_with("beliefs_"), names_to = "question", values_to = "response") %>%
  mutate(question = case_when(question == "beliefs_positives_cool_the_neighborhood" ~ "cool the neighbourhood",
                              question == "beliefs_positives_are_spiritual" ~ "are spiritual"),
         
         city_type = case_when(city_type == 1 ~ "inner",
                         city_type == 2 ~ "middle",
                         city_type == 3 ~ "outer",
                         city_type == 4 ~ "regional"))

make_boxplot(long_pos_ctype, long_pos_ctype$city_type, c("inner", "middle", "outer", "regional"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

make_barplot(long_pos_ctype, long_pos_ctype$city_type, c("inner", "middle", "outer", "regional"), c("#c2d6a4", "#669d62",  "#1f5b25", "#192813"))

```

------------------------------------------------------------------------

### Next Steps

1.  All decide if we want a meeting to discuss progress so far/next steps/etc.

2.  Hiên, Emile, and Carly consult on current methodology/variables chosen, do we agree? Should we add/remove? Code responses differently? Should we add interactions?

3.  Hiên and Emile assist Bella in crafting more specific predictions

4.  All decide if we want to incorporate street tree cover into the model

5.  Bella finalizes models + finds better way to visualize/present outputs


*NOTE:* In the survey, the question asked is "Do you speak any language other than English at home? If yes, please specify". For people that answered no, I have coded them as "English first language". For those who answered yes and responded with only french, I have coded them as "French first language". For those who answered yes, specified a language other than French or English, I identified what language they answered the survey in and coded them as "English preferred official language" or "French preferred official language". I don't know if this is appropriate, I don't want to center English and French as the only important/interesting languages, and can add more levels to this variable, but am unsure of the best way to do this, especially for people who responded with multiple languages as the language they speak at home. I would love everyone's thoughts on this issue.
